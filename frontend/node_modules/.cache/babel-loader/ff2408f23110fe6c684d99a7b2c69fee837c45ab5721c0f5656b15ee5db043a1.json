{"ast":null,"code":"import { showErrorMsg } from './event-bus.service';\nimport { httpService } from './http.service.js';\nconst STORAGE_KEY_LOGGEDIN_USER = 'loggedinUser';\nexport const userService = {\n  getById,\n  signup,\n  login,\n  logout,\n  getEmptyCredentials,\n  getLoggedinUser\n};\nfunction getById(userId) {\n  return httpService.get(`user/${userId}`);\n}\nasync function signup(userCred) {\n  try {\n    const user = await httpService.post('auth/signup', userCred);\n    return saveLocalUser(user);\n  } catch {\n    showErrorMsg('Username is already taken');\n  }\n}\nfunction saveLocalUser(user) {\n  user = {\n    _id: user._id,\n    username: user.username\n  };\n  sessionStorage.setItem(STORAGE_KEY_LOGGEDIN_USER, JSON.stringify(user));\n  return user;\n}\nasync function login(userCred) {\n  try {\n    const user = await httpService.post('auth/login', userCred);\n    if (user) {\n      return saveLocalUser(user);\n    }\n  } catch {\n    showErrorMsg('Invalid username or password');\n  }\n}\nasync function logout() {\n  sessionStorage.removeItem(STORAGE_KEY_LOGGEDIN_USER);\n  return await httpService.post('auth/logout');\n}\nfunction getEmptyCredentials() {\n  let username = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n  return {\n    username\n  };\n}\nfunction getLoggedinUser() {\n  console.log(JSON.parse(sessionStorage.getItem('loggedinUser') || null));\n  return JSON.parse(sessionStorage.getItem('loggedinUser') || null);\n}","map":{"version":3,"names":["showErrorMsg","httpService","STORAGE_KEY_LOGGEDIN_USER","userService","getById","signup","login","logout","getEmptyCredentials","getLoggedinUser","userId","get","userCred","user","post","saveLocalUser","_id","username","sessionStorage","setItem","JSON","stringify","removeItem","arguments","length","undefined","console","log","parse","getItem"],"sources":["/Users/orit/Documents/CodingAcademy/spotify/frontend/src/services/user.service.js"],"sourcesContent":["\r\nimport { showErrorMsg } from './event-bus.service'\r\nimport { httpService } from './http.service.js'\r\n\r\nconst STORAGE_KEY_LOGGEDIN_USER = 'loggedinUser'\r\n\r\nexport const userService = {\r\n  getById,\r\n  signup,\r\n  login,\r\n  logout,\r\n  getEmptyCredentials,\r\n  getLoggedinUser,\r\n}\r\n\r\n\r\nfunction getById(userId) {\r\n  return httpService.get(`user/${userId}`)\r\n}\r\n\r\n\r\nasync function signup(userCred) {\r\n  try {\r\n    const user = await httpService.post('auth/signup', userCred)\r\n    return saveLocalUser(user)\r\n  }\r\n  catch { showErrorMsg('Username is already taken') }\r\n\r\n\r\n}\r\nfunction saveLocalUser(user) {\r\n  user = { _id: user._id, username: user.username }\r\n  sessionStorage.setItem(STORAGE_KEY_LOGGEDIN_USER, JSON.stringify(user))\r\n  return user\r\n}\r\n\r\nasync function login(userCred) {\r\n  try {\r\n    const user = await httpService.post('auth/login', userCred)\r\n    if (user) {\r\n      return saveLocalUser(user)\r\n    }\r\n  } catch {\r\n    showErrorMsg('Invalid username or password')\r\n  }\r\n}\r\nasync function logout() {\r\n  sessionStorage.removeItem(STORAGE_KEY_LOGGEDIN_USER)\r\n  return await httpService.post('auth/logout')\r\n}\r\n\r\n\r\nfunction getEmptyCredentials(username = '') {\r\n  return { username }\r\n}\r\n\r\nfunction getLoggedinUser() {\r\n  console.log(JSON.parse(sessionStorage.getItem('loggedinUser') || null))\r\n  return JSON.parse(sessionStorage.getItem('loggedinUser') || null)\r\n}\r\n\r\n"],"mappings":"AACA,SAASA,YAAY,QAAQ,qBAAqB;AAClD,SAASC,WAAW,QAAQ,mBAAmB;AAE/C,MAAMC,yBAAyB,GAAG,cAAc;AAEhD,OAAO,MAAMC,WAAW,GAAG;EACzBC,OAAO;EACPC,MAAM;EACNC,KAAK;EACLC,MAAM;EACNC,mBAAmB;EACnBC;AACF,CAAC;AAGD,SAASL,OAAOA,CAACM,MAAM,EAAE;EACvB,OAAOT,WAAW,CAACU,GAAG,CAAE,QAAOD,MAAO,EAAC,CAAC;AAC1C;AAGA,eAAeL,MAAMA,CAACO,QAAQ,EAAE;EAC9B,IAAI;IACF,MAAMC,IAAI,GAAG,MAAMZ,WAAW,CAACa,IAAI,CAAC,aAAa,EAAEF,QAAQ,CAAC;IAC5D,OAAOG,aAAa,CAACF,IAAI,CAAC;EAC5B,CAAC,CACD,MAAM;IAAEb,YAAY,CAAC,2BAA2B,CAAC;EAAC;AAGpD;AACA,SAASe,aAAaA,CAACF,IAAI,EAAE;EAC3BA,IAAI,GAAG;IAAEG,GAAG,EAAEH,IAAI,CAACG,GAAG;IAAEC,QAAQ,EAAEJ,IAAI,CAACI;EAAS,CAAC;EACjDC,cAAc,CAACC,OAAO,CAACjB,yBAAyB,EAAEkB,IAAI,CAACC,SAAS,CAACR,IAAI,CAAC,CAAC;EACvE,OAAOA,IAAI;AACb;AAEA,eAAeP,KAAKA,CAACM,QAAQ,EAAE;EAC7B,IAAI;IACF,MAAMC,IAAI,GAAG,MAAMZ,WAAW,CAACa,IAAI,CAAC,YAAY,EAAEF,QAAQ,CAAC;IAC3D,IAAIC,IAAI,EAAE;MACR,OAAOE,aAAa,CAACF,IAAI,CAAC;IAC5B;EACF,CAAC,CAAC,MAAM;IACNb,YAAY,CAAC,8BAA8B,CAAC;EAC9C;AACF;AACA,eAAeO,MAAMA,CAAA,EAAG;EACtBW,cAAc,CAACI,UAAU,CAACpB,yBAAyB,CAAC;EACpD,OAAO,MAAMD,WAAW,CAACa,IAAI,CAAC,aAAa,CAAC;AAC9C;AAGA,SAASN,mBAAmBA,CAAA,EAAgB;EAAA,IAAfS,QAAQ,GAAAM,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAG,EAAE;EACxC,OAAO;IAAEN;EAAS,CAAC;AACrB;AAEA,SAASR,eAAeA,CAAA,EAAG;EACzBiB,OAAO,CAACC,GAAG,CAACP,IAAI,CAACQ,KAAK,CAACV,cAAc,CAACW,OAAO,CAAC,cAAc,CAAC,IAAI,IAAI,CAAC,CAAC;EACvE,OAAOT,IAAI,CAACQ,KAAK,CAACV,cAAc,CAACW,OAAO,CAAC,cAAc,CAAC,IAAI,IAAI,CAAC;AACnE"},"metadata":{},"sourceType":"module","externalDependencies":[]}